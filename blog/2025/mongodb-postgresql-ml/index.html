<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> From MongoDB to PostgreSQL: Database Architecture for ML Projects | Pinco Pallino </title> <meta name="author" content="Pinco Pallino"> <meta name="description" content="Why I used both NoSQL and SQL databases in my data pipeline, and when each makes sense"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%A8%F0%9F%8F%BB%E2%80%8D%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://unique-cocada-065d88.netlify.app//blog/2025/mongodb-postgresql-ml/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Pinco</span> Pallino </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">From MongoDB to PostgreSQL: Database Architecture for ML Projects</h1> <p class="post-meta"> Created on June 20, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/data-engineering"> <i class="fa-solid fa-hashtag fa-sm"></i> data-engineering</a>   <a href="/blog/tag/databases"> <i class="fa-solid fa-hashtag fa-sm"></i> databases</a>   <a href="/blog/tag/architecture"> <i class="fa-solid fa-hashtag fa-sm"></i> architecture</a>   ·   <a href="/blog/category/data-science"> <i class="fa-solid fa-tag fa-sm"></i> data-science</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="the-problem-from-raw-html-to-ml-ready-data">The Problem: From Raw HTML to ML-Ready Data</h2> <p>In my <a href="/projects/italian-real-estate/">Italian Real Estate project</a>, I needed to build a pipeline that transformed messy web data into clean, ML-ready datasets.</p> <p><strong>The journey:</strong></p> <ol> <li>Scrape 1M+ property listings from Italian real estate websites (raw HTML)</li> <li>Extract 50+ fields from unstructured HTML</li> <li>Translate Italian text to English</li> <li>Create a normalized, relational schema</li> <li>Train ML models to predict rental prices</li> </ol> <p><strong>The question:</strong> What database architecture supports this progression from chaos to structure?</p> <p><strong>The answer:</strong> Use <strong>both</strong> MongoDB (datalake + warehouse) and PostgreSQL (analytics-ready), with clear transitions between them.</p> <p>This post explains why I made this choice and how the multi-database architecture evolved.</p> <hr> <h2 id="the-three-layer-architecture">The Three-Layer Architecture</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/italian-real-estate/italian-real-estate-project-structure-480.webp 480w,/assets/img/projects/italian-real-estate/italian-real-estate-project-structure-800.webp 800w,/assets/img/projects/italian-real-estate/italian-real-estate-project-structure-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/italian-real-estate/italian-real-estate-project-structure.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Data pipeline architecture" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Three-layer architecture: MongoDB datalake → MongoDB warehouse → PostgreSQL analytics database </div> <h3 id="layer-1-mongodb-datalake-raw-html">Layer 1: MongoDB Datalake (Raw HTML)</h3> <p><strong>Contents:</strong> Raw HTML from web scraping</p> <p><strong>Why MongoDB?</strong></p> <ul> <li>✅ <strong>Schema flexibility</strong>: Each listing might have different fields</li> <li>✅ <strong>Nested data</strong>: HTML structure is hierarchical</li> <li>✅ <strong>Fast writes</strong>: Scraping generates data quickly</li> <li>✅ <strong>Temporal tracking</strong>: Store multiple scrapes over time</li> </ul> <p><strong>Schema:</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">_id</span><span class="dl">"</span><span class="p">:</span> <span class="nc">ObjectId</span><span class="p">(</span><span class="dl">"</span><span class="s2">...</span><span class="dl">"</span><span class="p">),</span>
  <span class="dl">"</span><span class="s2">url</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://immobiliare.it/...</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">html</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;html&gt;...&lt;/html&gt;</span><span class="dl">"</span><span class="p">,</span>  <span class="c1">// Raw HTML</span>
  <span class="dl">"</span><span class="s2">timestamp</span><span class="dl">"</span><span class="p">:</span> <span class="nc">ISODate</span><span class="p">(</span><span class="dl">"</span><span class="s2">2025-01-15T10:30:00Z</span><span class="dl">"</span><span class="p">),</span>
  <span class="dl">"</span><span class="s2">province</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Milan</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">listing_type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">rent</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>Why not PostgreSQL here?</strong></p> <ul> <li>HTML is unstructured → No fixed schema yet</li> <li>Don’t know what fields exist until parsing</li> <li>Need flexibility during exploration</li> </ul> <h3 id="layer-2-mongodb-warehouse-structured-documents">Layer 2: MongoDB Warehouse (Structured Documents)</h3> <p><strong>Contents:</strong> Extracted, structured data (still in JSON/document format)</p> <p><strong>Why MongoDB?</strong></p> <ul> <li>✅ <strong>Still evolving schema</strong>: Discovering new fields during ETL</li> <li>✅ <strong>Nested structures</strong>: Amenities, features as sub-documents</li> <li>✅ <strong>Easy iteration</strong>: Can add/remove fields without migrations</li> </ul> <p><strong>Schema:</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">_id</span><span class="dl">"</span><span class="p">:</span> <span class="nc">ObjectId</span><span class="p">(</span><span class="dl">"</span><span class="s2">...</span><span class="dl">"</span><span class="p">),</span>
  <span class="dl">"</span><span class="s2">listing_id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">12345</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">price</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">surface</span><span class="dl">"</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">rooms</span><span class="dl">"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">location</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">latitude</span><span class="dl">"</span><span class="p">:</span> <span class="mf">45.4642</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">longitude</span><span class="dl">"</span><span class="p">:</span> <span class="mf">9.1900</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">province</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Milan</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">city</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Milano</span><span class="dl">"</span>
  <span class="p">},</span>
  <span class="dl">"</span><span class="s2">amenities</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">elevator</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">balcony</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">parking</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span>
  <span class="p">},</span>
  <span class="dl">"</span><span class="s2">energy</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">class</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">B</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">consumption</span><span class="dl">"</span><span class="p">:</span> <span class="mf">75.5</span>
  <span class="p">},</span>
  <span class="dl">"</span><span class="s2">scraped_at</span><span class="dl">"</span><span class="p">:</span> <span class="nc">ISODate</span><span class="p">(</span><span class="dl">"</span><span class="s2">...</span><span class="dl">"</span><span class="p">),</span>
  <span class="dl">"</span><span class="s2">language</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Italian</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>This is the “messy middle” layer</strong> where data is structured but not yet normalized.</p> <h3 id="layer-3-postgresql-ml-ready-analytics">Layer 3: PostgreSQL (ML-Ready Analytics)</h3> <p><strong>Contents:</strong> Normalized, relational, ML-ready data</p> <p><strong>Why PostgreSQL?</strong></p> <ul> <li>✅ <strong>Relational integrity</strong>: Foreign keys, constraints</li> <li>✅ <strong>Query performance</strong>: Joins, aggregations, indexes</li> <li>✅ <strong>Data normalization</strong>: No redundancy (snowflake schema)</li> <li>✅ <strong>Type safety</strong>: Strong typing for ML features</li> <li>✅ <strong>Standard SQL</strong>: Compatible with ML tools (pandas, scikit-learn)</li> </ul> <p><strong>Schema (Snowflake):</strong></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/italian-real-estate/PostgreSQL_warehouse_ERD-480.webp 480w,/assets/img/projects/italian-real-estate/PostgreSQL_warehouse_ERD-800.webp 800w,/assets/img/projects/italian-real-estate/PostgreSQL_warehouse_ERD-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/italian-real-estate/PostgreSQL_warehouse_ERD.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="PostgreSQL schema" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> PostgreSQL snowflake schema with fact table (listings) and dimension tables </div> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Fact table</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">listings</span> <span class="p">(</span>
    <span class="n">listing_id</span> <span class="nb">SERIAL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="n">price</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">surface</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">rooms</span> <span class="nb">INTEGER</span><span class="p">,</span>
    <span class="n">property_type_id</span> <span class="nb">INTEGER</span> <span class="k">REFERENCES</span> <span class="n">property_types</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
    <span class="n">energy_class_id</span> <span class="nb">INTEGER</span> <span class="k">REFERENCES</span> <span class="n">energy_classes</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
    <span class="n">province_id</span> <span class="nb">INTEGER</span> <span class="k">REFERENCES</span> <span class="n">provinces</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
    <span class="n">latitude</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
    <span class="n">longitude</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
    <span class="n">elevator</span> <span class="nb">BOOLEAN</span><span class="p">,</span>
    <span class="n">balcony</span> <span class="nb">BOOLEAN</span><span class="p">,</span>
    <span class="c1">-- ... 40+ more fields</span>
<span class="p">);</span>

<span class="c1">-- Dimension tables (normalized)</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">property_types</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">SERIAL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="n">name</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">UNIQUE</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">energy_classes</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">SERIAL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="k">class</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">UNIQUE</span><span class="p">,</span>
    <span class="n">description</span> <span class="nb">TEXT</span>
<span class="p">);</span>

<span class="c1">-- ... more dimension tables</span>
</code></pre></div></div> <p><strong>This is the final, clean layer</strong> optimized for ML model training.</p> <hr> <h2 id="why-not-just-use-one-database">Why Not Just Use One Database?</h2> <h3 id="why-not-postgresql-for-everything">Why Not PostgreSQL for Everything?</h3> <p><strong>Could I have used PostgreSQL from the start?</strong></p> <p>Technically yes, but it would have been painful:</p> <p><strong>Problems with PostgreSQL for raw data:</strong></p> <ol> <li> <strong>Schema rigidity</strong> <ul> <li>Need to define schema upfront</li> <li>Adding fields requires migrations</li> <li>Early exploration is slow</li> </ul> </li> <li> <strong>Messy nested data</strong> <ul> <li>HTML parsing produces inconsistent structures</li> <li>Would need JSONB columns (loses benefits of relational DB)</li> </ul> </li> <li> <strong>Rapid iteration</strong> <ul> <li>During ETL development, schema changes constantly</li> <li>ALTER TABLE for every discovery is tedious</li> </ul> </li> </ol> <p><strong>Example pain point:</strong></p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Week 1: Define schema</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">raw_listings</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">SERIAL</span><span class="p">,</span>
    <span class="n">html</span> <span class="nb">TEXT</span><span class="p">,</span>
    <span class="n">price</span> <span class="nb">INTEGER</span>
<span class="p">);</span>

<span class="c1">-- Week 2: Realize need more fields</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">raw_listings</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">surface</span> <span class="nb">NUMERIC</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">raw_listings</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">energy_class</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="c1">-- Week 3: More discoveries</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">raw_listings</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">heating_type</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">raw_listings</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">building_year</span> <span class="nb">INTEGER</span><span class="p">;</span>

<span class="c1">-- Week 4: Realize structure was wrong, need to denormalize differently</span>
<span class="c1">-- ... painful restructuring</span>
</code></pre></div></div> <p>With MongoDB, I could just add fields as I discovered them:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Week 1</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">listings</span><span class="p">.</span><span class="nf">insertOne</span><span class="p">({</span><span class="na">price</span><span class="p">:</span> <span class="mi">1200</span><span class="p">})</span>

<span class="c1">// Week 2</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">listings</span><span class="p">.</span><span class="nf">insertOne</span><span class="p">({</span><span class="na">price</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span> <span class="na">surface</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span> <span class="na">energy_class</span><span class="p">:</span> <span class="dl">"</span><span class="s2">B</span><span class="dl">"</span><span class="p">})</span>

<span class="c1">// Week 3</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">listings</span><span class="p">.</span><span class="nf">insertOne</span><span class="p">({</span><span class="na">price</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span> <span class="p">...,</span> <span class="na">heating_type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">autonomous</span><span class="dl">"</span><span class="p">})</span>

<span class="c1">// No migrations needed!</span>
</code></pre></div></div> <h3 id="why-not-mongodb-for-everything">Why Not MongoDB for Everything?</h3> <p><strong>Could I have trained ML models directly on MongoDB?</strong></p> <p>Also yes, but suboptimal:</p> <p><strong>Problems with MongoDB for ML:</strong></p> <ol> <li> <strong>Query performance</strong> <ul> <li>Joins are awkward (manual <code class="language-plaintext highlighter-rouge">$lookup</code> or client-side)</li> <li>Aggregations are verbose</li> <li>Slower than SQL for analytical queries</li> </ul> </li> <li> <strong>Data integrity</strong> <ul> <li>No foreign keys → Data can be inconsistent</li> <li>No type enforcement → Strings mixed with numbers</li> <li>ML models need clean, consistent data</li> </ul> </li> <li> <strong>ML tooling</strong> <ul> <li>Pandas, scikit-learn expect flat, relational data</li> <li>Would need to flatten JSON every time</li> </ul> </li> </ol> <p><strong>Example query comparison:</strong></p> <p><strong>MongoDB</strong> (get average price by property type):</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">db</span><span class="p">.</span><span class="nx">listings</span><span class="p">.</span><span class="nf">aggregate</span><span class="p">([</span>
  <span class="p">{</span><span class="na">$group</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$property_type</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">avg_price</span><span class="p">:</span> <span class="p">{</span><span class="na">$avg</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$price</span><span class="dl">"</span><span class="p">}</span>
  <span class="p">}},</span>
  <span class="p">{</span><span class="na">$sort</span><span class="p">:</span> <span class="p">{</span><span class="na">avg_price</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}}</span>
<span class="p">])</span>
</code></pre></div></div> <p><strong>PostgreSQL</strong> (same query):</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">pt</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="k">AVG</span><span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">price</span><span class="p">)</span> <span class="k">as</span> <span class="n">avg_price</span>
<span class="k">FROM</span> <span class="n">listings</span> <span class="n">l</span>
<span class="k">JOIN</span> <span class="n">property_types</span> <span class="n">pt</span> <span class="k">ON</span> <span class="n">l</span><span class="p">.</span><span class="n">property_type_id</span> <span class="o">=</span> <span class="n">pt</span><span class="p">.</span><span class="n">id</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">pt</span><span class="p">.</span><span class="n">name</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">avg_price</span> <span class="k">DESC</span><span class="p">;</span>
</code></pre></div></div> <p>For simple queries, MongoDB is fine. But ML feature engineering involves <strong>complex joins, window functions, and aggregations</strong>. SQL shines here.</p> <hr> <h2 id="the-etl-pipeline-mongodb--postgresql">The ETL Pipeline: MongoDB → PostgreSQL</h2> <h3 id="phase-1-html--structured-documents-mongodb-datalake--warehouse">Phase 1: HTML → Structured Documents (MongoDB Datalake → Warehouse)</h3> <p><strong>Airflow DAG:</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">airflow</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="n">airflow.operators.python</span> <span class="kn">import</span> <span class="n">PythonOperator</span>

<span class="k">with</span> <span class="nc">DAG</span><span class="p">(</span><span class="sh">'</span><span class="s">mongodb_etl</span><span class="sh">'</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="sh">'</span><span class="s">@daily</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">dag</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">extract_from_html</span><span class="p">():</span>
        <span class="sh">"""</span><span class="s">Parse HTML and extract structured fields</span><span class="sh">"""</span>
        <span class="kn">from</span> <span class="n">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
        <span class="kn">import</span> <span class="n">pymongo</span>

        <span class="n">mongo</span> <span class="o">=</span> <span class="n">pymongo</span><span class="p">.</span><span class="nc">MongoClient</span><span class="p">()</span>
        <span class="n">datalake</span> <span class="o">=</span> <span class="n">mongo</span><span class="p">[</span><span class="sh">'</span><span class="s">real_estate_datalake</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">warehouse</span> <span class="o">=</span> <span class="n">mongo</span><span class="p">[</span><span class="sh">'</span><span class="s">real_estate_warehouse</span><span class="sh">'</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">datalake</span><span class="p">[</span><span class="sh">'</span><span class="s">raw_listings</span><span class="sh">'</span><span class="p">].</span><span class="nf">find</span><span class="p">():</span>
            <span class="n">soup</span> <span class="o">=</span> <span class="nc">BeautifulSoup</span><span class="p">(</span><span class="n">doc</span><span class="p">[</span><span class="sh">'</span><span class="s">html</span><span class="sh">'</span><span class="p">],</span> <span class="sh">'</span><span class="s">html.parser</span><span class="sh">'</span><span class="p">)</span>

            <span class="c1"># Extract fields
</span>            <span class="n">listing</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">listing_id</span><span class="sh">'</span><span class="p">:</span> <span class="nf">extract_listing_id</span><span class="p">(</span><span class="n">soup</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">price</span><span class="sh">'</span><span class="p">:</span> <span class="nf">extract_price</span><span class="p">(</span><span class="n">soup</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">surface</span><span class="sh">'</span><span class="p">:</span> <span class="nf">extract_surface</span><span class="p">(</span><span class="n">soup</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">location</span><span class="sh">'</span><span class="p">:</span> <span class="nf">extract_location</span><span class="p">(</span><span class="n">soup</span><span class="p">),</span>
                <span class="c1"># ... 50+ more fields
</span>            <span class="p">}</span>

            <span class="n">warehouse</span><span class="p">[</span><span class="sh">'</span><span class="s">listings</span><span class="sh">'</span><span class="p">].</span><span class="nf">insert_one</span><span class="p">(</span><span class="n">listing</span><span class="p">)</span>

    <span class="n">extract_task</span> <span class="o">=</span> <span class="nc">PythonOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="sh">'</span><span class="s">extract_structured_data</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">python_callable</span><span class="o">=</span><span class="n">extract_from_html</span>
    <span class="p">)</span>
</code></pre></div></div> <p><strong>Key steps:</strong></p> <ol> <li>Read raw HTML from datalake</li> <li>Parse with BeautifulSoup</li> <li>Extract structured fields</li> <li>Store in warehouse (still MongoDB)</li> </ol> <h3 id="phase-2-structured-documents--relational-mongodb--postgresql">Phase 2: Structured Documents → Relational (MongoDB → PostgreSQL)</h3> <p><strong>Migration script:</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pymongo</span>
<span class="kn">import</span> <span class="n">psycopg2</span>
<span class="kn">from</span> <span class="n">psycopg2.extras</span> <span class="kn">import</span> <span class="n">execute_batch</span>

<span class="k">def</span> <span class="nf">migrate_to_postgresql</span><span class="p">():</span>
    <span class="c1"># Connect to both databases
</span>    <span class="n">mongo</span> <span class="o">=</span> <span class="n">pymongo</span><span class="p">.</span><span class="nc">MongoClient</span><span class="p">()</span>
    <span class="n">pg_conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="sh">"</span><span class="s">dbname=real_estate ...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">pg_cursor</span> <span class="o">=</span> <span class="n">pg_conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>

    <span class="c1"># Migrate dimension tables first (for foreign keys)
</span>    <span class="n">property_types</span> <span class="o">=</span> <span class="nf">set</span><span class="p">()</span>
    <span class="n">energy_classes</span> <span class="o">=</span> <span class="nf">set</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">mongo</span><span class="p">[</span><span class="sh">'</span><span class="s">real_estate_warehouse</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">listings</span><span class="sh">'</span><span class="p">].</span><span class="nf">find</span><span class="p">():</span>
        <span class="n">property_types</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">property_type</span><span class="sh">'</span><span class="p">))</span>
        <span class="n">energy_classes</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">energy_class</span><span class="sh">'</span><span class="p">))</span>

    <span class="c1"># Insert dimension tables
</span>    <span class="nf">execute_batch</span><span class="p">(</span><span class="n">pg_cursor</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">INSERT INTO property_types (name) VALUES (%s) ON CONFLICT DO NOTHING</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">[(</span><span class="n">pt</span><span class="p">,)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">property_types</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="c1"># ... same for energy_classes, provinces, etc.
</span>
    <span class="c1"># Migrate fact table (listings)
</span>    <span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">mongo</span><span class="p">[</span><span class="sh">'</span><span class="s">real_estate_warehouse</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">listings</span><span class="sh">'</span><span class="p">].</span><span class="nf">find</span><span class="p">():</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">doc</span><span class="p">[</span><span class="sh">'</span><span class="s">price</span><span class="sh">'</span><span class="p">],</span>
            <span class="n">doc</span><span class="p">[</span><span class="sh">'</span><span class="s">surface</span><span class="sh">'</span><span class="p">],</span>
            <span class="n">doc</span><span class="p">[</span><span class="sh">'</span><span class="s">rooms</span><span class="sh">'</span><span class="p">],</span>
            <span class="nf">lookup_property_type_id</span><span class="p">(</span><span class="n">doc</span><span class="p">[</span><span class="sh">'</span><span class="s">property_type</span><span class="sh">'</span><span class="p">]),</span>
            <span class="nf">lookup_energy_class_id</span><span class="p">(</span><span class="n">doc</span><span class="p">[</span><span class="sh">'</span><span class="s">energy_class</span><span class="sh">'</span><span class="p">]),</span>
            <span class="n">doc</span><span class="p">[</span><span class="sh">'</span><span class="s">location</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">latitude</span><span class="sh">'</span><span class="p">],</span>
            <span class="n">doc</span><span class="p">[</span><span class="sh">'</span><span class="s">location</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">longitude</span><span class="sh">'</span><span class="p">],</span>
            <span class="c1"># ... 40+ more fields
</span>        <span class="p">)</span>
        <span class="n">batch</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="nf">execute_batch</span><span class="p">(</span><span class="n">pg_cursor</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">INSERT INTO listings (price, surface, ...) VALUES (%s, %s, ...)</span><span class="sh">"</span><span class="p">,</span>
                <span class="n">batch</span>
            <span class="p">)</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">pg_conn</span><span class="p">.</span><span class="nf">commit</span><span class="p">()</span>
</code></pre></div></div> <p><strong>Key steps:</strong></p> <ol> <li>Extract unique values for dimension tables</li> <li>Insert dimension tables first (for FK references)</li> <li>Flatten nested JSON into relational rows</li> <li>Batch insert for performance</li> </ol> <hr> <h2 id="the-translation-layer-italian--english">The Translation Layer: Italian → English</h2> <p>One complication: All scraped data was in Italian, but I wanted ML models to work with English.</p> <p><strong>Where to translate?</strong> Between MongoDB warehouse and PostgreSQL.</p> <h3 id="translation-pipeline">Translation Pipeline</h3> <p><strong>Architecture:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MongoDB Warehouse (Italian)
         ↓
   Translation Layer
    - LibreTranslate API
    - SQLite cache
    - Custom dictionary
         ↓
PostgreSQL (English)
</code></pre></div></div> <p><strong>Implementation:</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">sqlite3</span>
<span class="kn">import</span> <span class="n">requests</span>

<span class="k">class</span> <span class="nc">TranslationCache</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="sh">'</span><span class="s">translation_cache.db</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">create_table</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">conn</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">'''</span><span class="s">
            CREATE TABLE IF NOT EXISTS translations (
                italian TEXT PRIMARY KEY,
                english TEXT,
                field_name TEXT
            )
        </span><span class="sh">'''</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Translate with caching</span><span class="sh">"""</span>
        <span class="c1"># Check cache
</span>        <span class="n">cached</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">conn</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span>
            <span class="sh">'</span><span class="s">SELECT english FROM translations WHERE italian = ?</span><span class="sh">'</span><span class="p">,</span>
            <span class="p">(</span><span class="n">text</span><span class="p">,)</span>
        <span class="p">).</span><span class="nf">fetchone</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cached</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Check custom dictionary
</span>        <span class="k">if</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">REAL_ESTATE_DICTIONARY</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">REAL_ESTATE_DICTIONARY</span><span class="p">[</span><span class="n">text</span><span class="p">]</span>

        <span class="c1"># Call LibreTranslate API
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="sh">'</span><span class="s">http://localhost:5000/translate</span><span class="sh">'</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">source</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">it</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">target</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">en</span><span class="sh">'</span>
        <span class="p">})</span>
        <span class="n">translated</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">'</span><span class="s">translatedText</span><span class="sh">'</span><span class="p">]</span>

        <span class="c1"># Cache result
</span>        <span class="n">self</span><span class="p">.</span><span class="n">conn</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span>
            <span class="sh">'</span><span class="s">INSERT INTO translations VALUES (?, ?, ?)</span><span class="sh">'</span><span class="p">,</span>
            <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">translated</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">conn</span><span class="p">.</span><span class="nf">commit</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">translated</span>

<span class="c1"># Custom real estate dictionary
</span><span class="n">REAL_ESTATE_DICTIONARY</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">cucina abitabile</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">eat-in kitchen</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">occupato</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">inhabited</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">libero</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">vacant</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">piano terra</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">ground floor</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">ultimo piano</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">top floor</span><span class="sh">'</span><span class="p">,</span>
    <span class="c1"># ... 100+ phrases
</span><span class="p">}</span>
</code></pre></div></div> <p><strong>Performance:</strong></p> <ul> <li><strong>1M+ translations needed</strong></li> <li> <strong>Cache hit rate</strong>: ~80% (many repeated phrases)</li> <li> <strong>Custom dictionary</strong>: Handles domain-specific jargon</li> <li> <strong>Total time</strong>: ~6 hours (would be 30+ hours without caching)</li> </ul> <hr> <h2 id="performance-comparison-mongodb-vs-postgresql">Performance Comparison: MongoDB vs PostgreSQL</h2> <p>I ran the same analytical queries on both databases to compare:</p> <table> <thead> <tr> <th><strong>Query</strong></th> <th><strong>MongoDB</strong></th> <th><strong>PostgreSQL</strong></th> <th><strong>Winner</strong></th> </tr> </thead> <tbody> <tr> <td>Simple filter (price &gt; 1000)</td> <td>120ms</td> <td>45ms</td> <td>PostgreSQL</td> </tr> <tr> <td>Group by + aggregate</td> <td>850ms</td> <td>180ms</td> <td>PostgreSQL</td> </tr> <tr> <td>Join 3 tables</td> <td>2.1s (manual)</td> <td>320ms</td> <td>PostgreSQL</td> </tr> <tr> <td>Complex analytics query</td> <td>5.8s</td> <td>1.2s</td> <td>PostgreSQL</td> </tr> <tr> <td>Full table scan</td> <td>3.2s</td> <td>2.8s</td> <td>PostgreSQL</td> </tr> </tbody> </table> <p><strong>For ML feature engineering</strong> (lots of joins, aggregations, window functions): <strong>PostgreSQL is 3-5× faster</strong>.</p> <hr> <h2 id="lessons-learned">Lessons Learned</h2> <h3 id="1-use-the-right-tool-for-each-stage">1. Use the Right Tool for Each Stage</h3> <p><strong>MongoDB for early, exploratory stages:</strong></p> <ul> <li>Schema is evolving</li> <li>Data is messy/nested</li> <li>Fast iteration matters more than query performance</li> </ul> <p><strong>PostgreSQL for analytics and ML:</strong></p> <ul> <li>Schema is stable</li> <li>Need complex queries</li> <li>Data integrity matters</li> </ul> <p><strong>Don’t force one database to do everything.</strong></p> <h3 id="2-data-transformation-is-iterative">2. Data Transformation Is Iterative</h3> <p>My ETL pipeline evolved over weeks:</p> <ul> <li>Started with 20 fields → Ended with 50+</li> <li>Discovered nested structures that needed flattening</li> <li>Realized some fields needed custom parsing</li> </ul> <p><strong>MongoDB’s flexibility let me iterate fast</strong> without constant schema migrations.</p> <h3 id="3-translation-at-the-right-layer">3. Translation at the Right Layer</h3> <p>I initially considered three options:</p> <ol> <li>Translate during scraping (too early, brittle)</li> <li>Translate in MongoDB (wrong layer, should stay raw)</li> <li> <strong>Translate during MongoDB → PostgreSQL migration</strong> ← This worked</li> </ol> <p><strong>Why option 3?</strong></p> <ul> <li>MongoDB has raw Italian (preserves source)</li> <li>Translation happens once in batch (efficient)</li> <li>PostgreSQL gets clean English (ready for ML)</li> </ul> <h3 id="4-normalization-reduces-redundancy">4. Normalization Reduces Redundancy</h3> <p>In MongoDB warehouse, “Apartment” appeared 400,000+ times as a string.</p> <p>In PostgreSQL:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">property_types</code> table has one row: <code class="language-plaintext highlighter-rouge">(1, 'Apartment')</code> </li> <li> <code class="language-plaintext highlighter-rouge">listings</code> table references: <code class="language-plaintext highlighter-rouge">property_type_id = 1</code> </li> </ul> <p><strong>Storage savings:</strong> ~40% reduction in database size</p> <p><strong>Query benefits:</strong> Categorical features are indexed integers, not strings</p> <h3 id="5-start-simple-add-complexity-when-needed">5. Start Simple, Add Complexity When Needed</h3> <p><strong>Phase 1:</strong> I just used MongoDB (weeks 1-3)</p> <ul> <li>Got pipeline working</li> <li>Explored data structure</li> <li>Proved the concept</li> </ul> <p><strong>Phase 2:</strong> Added PostgreSQL (weeks 4-6)</p> <ul> <li>Optimized for ML</li> <li>Improved query performance</li> <li>Enforced data quality</li> </ul> <p><strong>I didn’t architect the “perfect” system upfront.</strong> I evolved it based on needs.</p> <hr> <h2 id="when-to-use-this-architecture">When to Use This Architecture</h2> <p><strong>Use MongoDB + PostgreSQL when:</strong></p> <p>✅ <strong>Data starts messy</strong> (web scraping, APIs, logs) ✅ <strong>Schema evolves during exploration</strong> ✅ <strong>End goal is ML/analytics</strong> (need SQL performance) ✅ <strong>You have time for ETL</strong> (not real-time streaming)</p> <p><strong>Just use PostgreSQL when:</strong></p> <p>✅ <strong>Schema is known upfront</strong> ✅ <strong>Data is already structured</strong> ✅ <strong>Mainly transactional workload</strong> (CRUD operations)</p> <p><strong>Just use MongoDB when:</strong></p> <p>✅ <strong>Schema will always be flexible</strong> ✅ <strong>Query patterns are simple</strong> (key-value lookups) ✅ <strong>Horizontal scaling is critical</strong></p> <hr> <h2 id="code--resources">Code &amp; Resources</h2> <p>Full pipeline implementation in my <a href="https://github.com/LeonardoPaccianiMori/italian-real-estate-pipeline" rel="external nofollow noopener" target="_blank">Italian Real Estate repository</a>:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">dags/mongodb_etl_dag.py</code> - Airflow ETL pipeline</li> <li> <code class="language-plaintext highlighter-rouge">dags/postgresql_migration_dag.py</code> - MongoDB → PostgreSQL migration</li> <li> <code class="language-plaintext highlighter-rouge">scripts/translate.py</code> - Translation layer</li> <li> <code class="language-plaintext highlighter-rouge">sql/schema.sql</code> - PostgreSQL schema definition</li> </ul> <p><strong>Related posts:</strong></p> <ul> <li> <a href="/blog/2025/synthetic-data-ctgan/">Custom Synthetic Data Algorithm</a> - Using PostgreSQL data for ML</li> <li> <a href="/projects/italian-real-estate/">Italian Real Estate Project</a> - Full pipeline overview</li> </ul> <hr> <h2 id="key-takeaways">Key Takeaways</h2> <ol> <li> <strong>Multi-database architectures are valid</strong> - Don’t feel obligated to use just one database</li> <li> <strong>Match database to data maturity</strong> - Flexible (MongoDB) for exploration, rigid (PostgreSQL) for production</li> <li> <strong>ETL is where the magic happens</strong> - Transform data to fit the right tool at each stage</li> <li> <strong>Normalization matters for ML</strong> - Clean, typed, non-redundant data = better models</li> <li> <strong>Start simple, evolve based on needs</strong> - Don’t over-architect upfront</li> </ol> <p>What database architecture have you used for ML projects? Have you found multi-database pipelines useful? Share your experiences!</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/" target="_blank" rel="external nofollow noopener">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2" target="_blank" rel="external nofollow noopener">Displaying External Posts on Your al-folio Blog</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/llm-insights-engine/">Building an LLM-Powered Insights Engine That Doesn't Hallucinate</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/synthetic-data-ctgan/">Why I Built a Custom Synthetic Data Algorithm Instead of Using CTGAN</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/simple-cnn-wins/">When Simpler Models Win: Comparing 7 CNN Architectures</a> </li> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Pinco Pallino. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>, forked from <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Last updated: October 24, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>